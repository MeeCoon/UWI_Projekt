const legalFormEl = document.getElementById("legalForm");
const capitalEl   = document.getElementById("startCapital");
const hintEl      = document.getElementById("capitalHint");

function minCapitalFor(form){
  if (form === "AG") return 100000;
  if (form === "GmbH") return 20000;
  return 0; // Einzelunternehmen
}

function updateCapitalRules(){
  const form = legalFormEl.value;
  const min  = minCapitalFor(form);

  capitalEl.min = String(min);

  if (form === "AG") {
    hintEl.textContent = "AG: Mindest-Startkapital 100'000 CHF";
  } else if (form === "GmbH") {
    hintEl.textContent = "GmbH: Mindest-Startkapital 20'000 CHF";
  } else {
    hintEl.textContent = "Einzelunternehmen: Kein Mindest-Startkapital";
  }

  // Wenn aktueller Wert kleiner ist, automatisch hochsetzen
  const current = Number(capitalEl.value || 0);
  if (current < min) capitalEl.value = String(min);
}

// beim Wechsel der Rechtsform sofort anpassen
legalFormEl.addEventListener("change", updateCapitalRules);

// beim Laden initial setzen
document.addEventListener("DOMContentLoaded", updateCapitalRules);

// beim Erstellen final prüfen (bevor speichern)
document.getElementById("createBtn")?.addEventListener("click", () => {
  const form = legalFormEl.value;
  const min  = minCapitalFor(form);
  const cap  = Number(capitalEl.value || 0);

  if (cap < min) {
    alert(`Startkapital ist zu klein. Minimum für ${form}: ${min.toLocaleString("de-CH")} CHF`);
    capitalEl.value = String(min);
    capitalEl.focus();
    return;
  }

  // ... ab hier deine bestehende "Firma speichern" Logik
});
